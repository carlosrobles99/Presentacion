<?xml version="1.0" encoding="UTF-8"?>
<!--
Plantilla ejercicio1-socios
* No olvides usar las entidades &lt; y &gt; para sustituir al < y > respectivamente.
-->
<ejercicios>
<ejercicio id="1" peso="1">select * from jugadores j inner join equipos e on j.nombre_equipo=e.nombre where e.conferencia like 'East';</ejercicio>
<ejercicio id="2" peso="1">select count(*) as Total_jugadores from jugadores j inner join equipos e on j.nombre_equipo=e.nombre where e.nombre like 'Lakers';</ejercicio>
<ejercicio id="3" peso="1">select j.nombre,j.peso from jugadores j having max(j.peso);</ejercicio>
<ejercicio id="4" peso="1">select j.nombre_equipo as Nombre_equipo,j.altura as Altura from equipos e inner join jugadores j on j.nombre_equipo = e.nombre group by e.nombre having max(j.altura) order by e.nombre;</ejercicio>
<ejercicio id="5" peso="1">select j.nombre as Nombre,j.altura as Altura from equipos e inner join jugadores j on j.nombre_equipo = e.nombre where e.conferencia like 'West' having max(j.altura);</ejercicio>
<ejercicio id="6" peso="1.5">select j.nombre as Nombre, round((j.peso/2.205),2) as PesoKg, round(substring(j.altura,1,1)*30.48 + substring(j.altura,3,3)*2.54) as AlturaCm  from jugadores j;</ejercicio>
<ejercicio id="7" peso="1.5">select e.nombre as Nombre_equipo,count(j.codigo) as NumJugadoresMas2Metros from jugadores j inner join equipos e  on j.nombre_equipo = e.nombre where round(substring(j.altura,1,1)*30.48 + substring(j.altura,3,3)*2.54) > 200 group by e.nombre;</ejercicio>
<ejercicio id="8" peso="1.5">select jugador.pro as Procedencia,sum(suma) as MediaPeso from( select j.procedencia as pro,avg(j.peso) as suma  from jugadores j where j.procedencia like 'Spain' or j.procedencia like 'France' or j.procedencia like 'Russia' or j.procedencia like 'Italy' or j.procedencia like 'Argentina' or j.procedencia like 'Brazil' or j.procedencia like 'Serbia' or j.procedencia like 'Slovenia' group by j.procedencia ) as jugador  group by jugador.pro order by MediaPeso desc;</ejercicio>
<ejercicio id="9" peso="1.5">select j.procedencia, count(j.codigo) as total from jugadores j where j.procedencia like 'Spain' or j.procedencia like 'France' or j.procedencia like 'Russia' or j.procedencia like 'Italy' or j.procedencia like 'Argentina' or j.procedencia like 'Brazil' or j.procedencia like 'Serbia' or j.procedencia like 'Slovenia' group by j.procedencia having total =  (select max(maximo) from( select count(x.codigo) as maximo from jugadores x where x.procedencia like 'Spain' or x.procedencia like 'France' or x.procedencia like 'Russia' or x.procedencia like 'Italy' or x.procedencia like 'Argentina' or x.procedencia like 'Brazil' or x.procedencia like 'Serbia' or x.procedencia like 'Slovenia'  group by x.procedencia) as derivada );</ejercicio>
<ejercicio id="10" peso="1.5">select e.nombre as Nombre_equipo, count(j.codigo) as NumJugadoresEsp from jugadores j inner join equipos e on e.nombre = j.nombre_equipo where j.procedencia like 'Spain' group by e.nombre order by NumJugadoresEsp desc, Nombre_equipo;</ejercicio>
<ejercicio id="11" peso="1.5">select e.nombre as Nombre_equipo, count(j.codigo) as NumJugadoresEsp, group_concat(j.nombre) as Jugadores from jugadores j inner join equipos e on e.nombre = j.nombre_equipo where j.procedencia like 'Spain' group by e.nombre order by NumJugadoresEsp desc, Nombre_equipo;</ejercicio>
<ejercicio id="12" peso="1.5">select j.nombre, e.nombre, e.conferencia, es.Puntos_por_partido, es.Asistencias_por_partido, es.Tapones_por_partido, es.Rebotes_por_partido from jugadores j  inner join estadisticas es on es.jugador=j.codigo  inner join equipos e on e.nombre=j.nombre_equipo  where es.temporada like '07/08' and j.procedencia like 'Spain' order by j.nombre;</ejercicio>
<ejercicio id="13" peso="1.5">select es.temporada as Temporada,sum(es.Puntos_por_partido) as Puntos from estadisticas es inner join jugadores j on j.codigo=es.jugador where j.nombre like 'Kobe Bryant' group by es.temporada having Puntos = (select max(maximo) from (  select sum(t.Puntos_por_partido) as maximo from estadisticas t inner join jugadores p on p.codigo=t.jugador where p.nombre like 'Kobe Bryant' group by t.temporada) as derivada );</ejercicio>
<ejercicio id="14" peso="1.5">select e.nombre, e.ciudad, e.conferencia,IF(e.conferencia like 'West', 'Oeste', 'Este') as Conferencia, e.division from equipos e order by e.ciudad,e.nombre;</ejercicio>
<ejercicio id="15" peso="2">select e.nombre as Nombre, e.ciudad as Ciudad, IF(e.conferencia like 'West', "Oeste", "Este") as Conferencia,   CASE WHEN e.division like 'Atlantic' THEN 'Atlantico'          WHEN e.division like 'SouthEast' THEN 'Sudeste'          WHEN e.division like 'Central' THEN 'Central'          WHEN e.division like 'Pacific' THEN 'Pacifico'          WHEN e.division like 'SouthWest' THEN 'Sudoeste'          WHEN e.division like 'NorthWest' THEN 'Noroeste'          ELSE e.division END AS 'Division'    from equipos e order by e.ciudad,e.nombre;</ejercicio>
<ejercicio id="16" peso="1.5">select j.nombre, es.Puntos_por_partido, es.Asistencias_por_partido, es.Tapones_por_partido, es.Rebotes_por_partido from estadisticas es  inner join jugadores j on j.codigo=es.jugador  where es.temporada like '06/07'  having (es.Puntos_por_partido > 10) and (es.Asistencias_por_partido > 10) or  (es.Puntos_por_partido > 10) and (es.Tapones_por_partido > 10) or (es.Puntos_por_partido > 10) and (es.Rebotes_por_partido > 10) or    (es.Asistencias_por_partido > 10) and (es.Puntos_por_partido > 10) or  (es.Asistencias_por_partido > 10) and (es.Tapones_por_partido > 10) or (es.Asistencias_por_partido > 10) and (es.Rebotes_por_partido > 10) or  (es.Tapones_por_partido > 10) and (es.Puntos_por_partido > 10) or  (es.Tapones_por_partido > 10) and (es.Asistencias_por_partido > 10) or (es.Tapones_por_partido > 10) and (es.Rebotes_por_partido > 10) or  (es.Rebotes_por_partido > 10) and (es.Puntos_por_partido > 10) or  (es.Rebotes_por_partido > 10) and (es.Asistencias_por_partido > 10) or (es.Rebotes_por_partido > 10) and (es.Tapones_por_partido > 10)   order by es.Puntos_por_partido desc;</ejercicio>
<ejercicio id="17" peso="1.5">select distinct e.division from equipos e inner join jugadores j on j.nombre_equipo=e.nombre where j.procedencia like 'Spain' or j.procedencia like 'Argentina' order by e.division;</ejercicio>
<ejercicio id="18" peso="1.5">select j.nombre, e.nombre from equipos e inner join jugadores j on j.nombre_equipo=e.nombre where e.division = (select distinct x.division from equipos x where division like 'Southwest') order by j.nombre, e.nombre;</ejercicio>
<ejercicio id="19" peso="2">select p.equipo_local, sum(p.puntos_local) as total     from partidos p     where p.temporada like '07/08'     group by p.equipo_local     order by total desc, p.equipo_local;</ejercicio>
<ejercicio id="20" peso="1.5">select p.equipo_local as EquipoLocal,count(p.equipo_local) as Victorias     from partidos p     where p.temporada like '07/08' and p.puntos_local > p.puntos_visitante     group by EquipoLocal     order by Victorias desc, EquipoLocal;</ejercicio>
<ejercicio id="21" peso="2">select p.equipo_visitante as EquipoVisitante,count(p.equipo_visitante) as Victorias     from partidos p     inner join equipos e     on e.nombre=p.equipo_visitante     where p.temporada like '07/08' and p.puntos_visitante > p.puntos_local     and e.conferencia like 'East'     group by EquipoVisitante     order by Victorias desc, EquipoVisitante asc     limit 2,3;</ejercicio>
<ejercicio id="22" peso="2">SELECT (SELECT round(avg(j.altura),4) FROM jugadores j             inner join equipos e             on e.nombre=j.nombre_equipo             where e.conferencia like 'West'              ) as AlturaWest ,round(avg(x.altura),4) as AlturaEast FROM jugadores x             inner join equipos t             on t.nombre=x.nombre_equipo             where t.conferencia like 'East';</ejercicio>
<ejercicio id="23" peso="2.5">select e.nombre as Equipo,sum(p.puntos_visitante)+sum(p.puntos_local) as Total     from partidos p     inner join equipos e     on e.nombre=p.equipo_local       where p.temporada like '07/08'     group by e.nombre     order by Total desc     limit 1;</ejercicio>
<ejercicio id="24" peso="1">insert into jugadores values (614,'Jose','Stanford','3-9',259,'C-F','Timberwolves'),     (615,'Carlos','North Carolina','3-4',180,'G','Timberwolves');</ejercicio>
<ejercicio id="25" peso="1.5">update estadisticas es  inner join jugadores j  on j.codigo=es.jugador  set es.puntos_por_partido=es.puntos_por_partido+2  where es.temporada like '07/08' and j.nombre_equipo like 'Lakers';</ejercicio>
<ejercicio id="26" peso="1">update equipos e set e.conferencia = IF(e.conferencia like 'West', 'Oeste', 'Este');</ejercicio>
<ejercicio id="27" peso="1">delete from estadisticas where temporada between '91/92' and '92/93';</ejercicio>
</ejercicios>







